<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">








    





<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">



<link rel="icon" type="image/ico" href="https://pelikan-dev.click/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://pelikan-dev.click/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://pelikan-dev.click/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="192x192" href="https://pelikan-dev.click/android-chrome-192x192.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://pelikan-dev.click/apple-touch-icon.png">

<meta name="description" content="이곳에 설명을 입력하세요"/>



<title>
    
    Back Propagation | Pelikan&#39;s Glide
    
</title>

<link rel="canonical" href="https://pelikan-dev.click/posts/back-propagation/"/>

<meta property="og:url" content="https://pelikan-dev.click/posts/back-propagation/">
  <meta property="og:site_name" content="Pelikan&#39;s Glide">
  <meta property="og:title" content="Back Propagation">
  <meta property="og:description" content="이곳에 설명을 입력하세요">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-28T17:30:55+09:00">
    <meta property="article:modified_time" content="2025-04-28T17:30:55+09:00">
    <meta property="article:tag" content="CNN">
    <meta property="article:tag" content="Computervision">
    <meta property="article:tag" content="MachineLearning">












<link rel="stylesheet" href="/assets/combined.min.104a7fee30ae385db782d9ae92a3b5b05f36936519aabc8b11655e4ed1a7ed69.css" media="all">















    




</head>







<body class="auto">

  <div class="content">
    <header>
      

<div class="header">

    

    <h1 class="header-title">
        <a href="https://pelikan-dev.click/">Pelikan&#39;s Glide</a>
    </h1>

    <div class="header-menu">
        

        
        

        <p
            class="small ">
            <a href="/" >
                /home
            </a>
        </p>
        

        <p
            class="small ">
            <a href="/posts" >
                /posts
            </a>
        </p>
        

        <p
            class="small ">
            <a href="/about" >
                /about
            </a>
        </p>
        
        
    </div>

    

</div>

    </header>

    <main class="main">
      




<div class="breadcrumbs"><a href="/">Home</a><span class="breadcrumbs-separator">/</span><a href="/posts/">Posts</a><span class="breadcrumbs-separator">/</span>
        <a href="/posts/back-propagation/">Back Propagation</a></div>


<div  class="autonumber" >
  <article>
    <header class="single-intro-container">
        
        <h1 class="single-title">Back Propagation</h1>
        <p class="single-summary">ComputerVision Lecture 9-1</p>
        
        <div class="single-subsummary">
          
          <div>
            
            <p class="single-date">
              <time datetime="2025-04-28T17:30:55&#43;09:00">April 28, 2025</time>
              &nbsp; · &nbsp;2 min read
            </p>
          </div>
        </div>
        
    </header>    
        <div class="single-tags"><span>
                  <a href="https://pelikan-dev.click/tags/cnn/">#CNN</a>
                </span><span>
                  <a href="https://pelikan-dev.click/tags/computervision/">#Computervision</a>
                </span><span>
                  <a href="https://pelikan-dev.click/tags/machinelearning/">#MachineLearning</a>
                </span>
        </div>
      <aside class="toc">
        <p><strong>Table of contents</strong></p>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#model-fitting">Model Fitting</a></li>
    <li><a href="#gradient-descent">Gradient Descent</a></li>
    <li><a href="#propagation">Propagation</a></li>
    <li><a href="#implementation">Implementation</a></li>
  </ul>
</nav>
      </aside>
    
    <div class="single-content">
      <h2 class="heading" id="model-fitting">
  Model Fitting
  <a class="anchor" href="#model-fitting">#</a>
</h2>
<p>$$
L(w) = \lambda ||w||^2_2 + \sum_{i=1}^n(y_i - w^Tx_i))^2
$$</p>
<h2 class="heading" id="gradient-descent">
  Gradient Descent
  <a class="anchor" href="#gradient-descent">#</a>
</h2>
<p>$$
w_{i+1} = w_i - \alpha \nabla_wL(f(w_i))
$$</p>
<h3 class="heading" id="exempli-gratia">
  exempli gratia
  <a class="anchor" href="#exempli-gratia">#</a>
</h3>
<p>$$
\begin{align*}
&amp;f(x) = (-x+3)^2 \newline
&amp;f = q^2\quad q=r+3\quad r=-x\newline
&amp;\frac{\partial f}{\partial q} = 2q, \quad \frac{\partial q}{\partial r} = 1,\quad \frac{\partial r}{\partial x} = -1\newline
&amp;\frac{\partial f}{\partial x} = \frac{\partial f}{\partial q} \frac{\partial q}{\partial r} \frac{\partial r}{\partial x} = 2q * 1 * -1\newline
&amp;= 2x-6
\end{align*}
$$</p>
<h2 class="heading" id="propagation">
  Propagation
  <a class="anchor" href="#propagation">#</a>
</h2>
<h3 class="heading" id="forward-pass">
  Forward Pass
  <a class="anchor" href="#forward-pass">#</a>
</h3>
<p>Given forward input <strong>n</strong>을 통해 <strong>f</strong>(<strong>n</strong>)을 계산</p>
<p>$$
\begin{align*}
&amp;f(x) = (-x+3)^2 \newline
&amp;x\longrightarrow [-n] \longrightarrow [n+3] \longrightarrow [n^2] \Longrightarrow (-x+3)^2 \newline
\end{align*}
$$</p>
<h3 class="heading" id="backward-pass">
  Backward Pass
  <a class="anchor" href="#backward-pass">#</a>
</h3>
<p>Given backwards input은 g(출력값)을 통해 $g*\dfrac{\partial f(n)}{\partial n}$을 리턴한다.</p>
<p>$$
\begin{align*}
&amp;\dfrac{\partial x}{\partial x} = 1 \longrightarrow 1 * \dfrac{\partial}{\partial n} n^2 = 2n \longrightarrow 2n * \dfrac{\partial}{\partial n}n+3 = 2n \ - \newline
&amp; \quad \quad \quad \rightarrow 2n * \dfrac{\partial}{\partial n} (-n) = -2n \Longrightarrow -2n = -2(-x+3) = 2x-6
\end{align*}
$$</p>
<pre class="mermaid">%%{init: {&#39;flowchart&#39;: {&#39;curve&#39;: &#39;linear&#39;}}}%%
flowchart LR
    %% Forward Pass
    n --&gt;|입력 n| fblock[f]
    fblock --&gt;|f（n）| out[f]

    %% Backward Pass (Gradient)
    g_in[&#34;g&#34;] ---|up스트림 gradient| fblock 
    fblock ---|g × ∂f（n）/∂n| grad_out[&#34;g × ∂f（n）/∂n&#34;]
</pre>

<h3 class="heading" id="sigmoid">
  Sigmoid
  <a class="anchor" href="#sigmoid">#</a>
</h3>
<p>시그모이드와 같이 복잡한 수식은 하나씩 propagation하는 것이 아닌 block처럼 중첩시켜 연산할 수 있다.</p>
<p>$$
\sigma(n) = \frac{1}{1+e^{-n}}\newline
\dfrac{\partial}{\partial n}\sigma(n) = (1-\sigma(n))\sigma(n)
$$</p>
<h2 class="heading" id="implementation">
  Implementation
  <a class="anchor" href="#implementation">#</a>
</h2>
<p>ReLU함수를 propagation하는 코드는 아래와 같다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ReLULayer</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grad_output</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">grad_input</span> <span class="o">=</span> <span class="n">grad_output</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">grad_input</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">grad_input</span>
</span></span></code></pre></div>
    </div>
  </article>

  
  
  
  <script defer
    type="module"
    id="mermaid_script"
    data-light-theme="default"
    data-dark-theme="dark"
    src='/js/mermaid.js'>
  </script>
  

  

  
  

<div class="single-pagination">
    <hr />

    <div class="flexnowrap">

        <div class="single-pagination-prev">
            
            <div class="single-pagination-container-prev">
                <div class="single-pagination-text">←</div>
                <div class="single-pagination-text">
                    <a href="/posts/linear-models_ml/">
                        Linear-Models(ML)
                    </a>
                </div>
            </div>
            
        </div>

        <div class="single-pagination-next">
            
            <div class="single-pagination-container-next">
                <div class="single-pagination-text">
                    <a href="/posts/algorithm/dynamic-programming-1/">
                        Dynamic Programming: N으로 표현
                    </a>
                </div>
                <div class="single-pagination-text">→</div>
            </div>
            
        </div>

    </div>

    <hr />
</div>



  

  

  
  <div class="back-to-top">
    <a href="#top">
      back to top
    </a>
  </div>
  

</div>


    </main>
  </div>

  
  





    




  <footer>
    

    
    





    




    
    <p>Powered by
        <a href="https://gohugo.io/">Hugo</a>
        and
        <a href="https://github.com/tomfran/typo">tomfran/typo</a>
    </p>
    
    
    


  </footer>

  
  <link rel="stylesheet" 
  href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css">
  
<script defer 
  src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script>

<script defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"
  onload="renderMathInElement(document.body);"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false }
      ]
    });
  });
</script>
  
</body>

<script src="/js/theme-switch.js"></script>
<script defer src="/js/copy-code.js"></script>
</html>
